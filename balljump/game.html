<html>
    <body>
        <h1>Ball Jump Game</h1>
        <canvas id="gameCanvas" style="background-color: lightblue;"></canvas>

        <script>

            function draw(drawingCtx, color, xPos, yPos, radius){
                // Update the game entities
                
                // Clear previous frame.
                drawingCtx.clearRect(0, 0, canvas.width, canvas.height);

                // Draws current context
                // Draws ball
                drawingCtx.fillStyle = color;
                drawingCtx.beginPath();
                drawingCtx.arc(xPos, yPos, radius, 0, 2 * Math.PI);
                drawingCtx.fill();

                // Draws obstacles
                drawingCtx.fillStyle = "black";
                drawingCtx.fillRect(obstacles[0].x, obstacles[0].y, obstacleWidth, obstacleHeight);
            }            

            function update(ball, obstacles, gravity){
                // Update the game entities
                if (ball.jumping) {
                    ball.vy += gravity;
                    ball.y += ball.vy;

                    if (ball.y + ball.radius >= canvas.height){
                        ball.jumping = false;
                        ball.y = canvas.height - ball.radius;
                    }
                }

                obstacles[0].x -= speed
            }

            function jump(){
                if (!ball.jumping){
                    ball.vy = -8;
                    ball.jumping = true;
                }
            }

            function gameLoop(){
                update(ball, obstacles, gravity);
                draw(drawingCtx, "red", ball.x, ball.y, ball.radius)
                requestAnimationFrame(gameLoop)
            }


            // Canvas init
            const canvas = document.getElementById("gameCanvas");
            canvas.width = 600;
            canvas.height = 300;

            // Obstacles init
            const speed = 3;
            const obstacleWidth = 20;
            const obstacleHeight = 50;
            const obstacles = [
                { x: canvas.width, y: canvas.height - obstacleHeight }
            ]

            const ball = {
                x: 50,
                y: 50,
                vy: 0, // Vertical velocity
                radius: 15,
                jumping: true,
            }
            const gravity = 0.4;

            const drawingCtx = canvas.getContext("2d");

            document.addEventListener(
              "keydown", 
              (event) => { if (event.code === "Space") jump()}
            ); 
            gameLoop();

        </script>
    </body>
</html>